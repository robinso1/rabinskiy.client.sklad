# Инструкция по деплою на Render

## Подготовка к деплою

### 1. Подготовка проекта

Убедитесь, что в проекте есть следующие файлы:
- `Dockerfile` - для сборки контейнера
- `render.yaml` - для настройки деплоя на Render
- `server/.env.production` - шаблон переменных окружения для продакшена

## Деплой на Render

### 1. Создание нового веб-сервиса

1. Зарегистрируйтесь или войдите в [Render](https://render.com/)
2. Нажмите "New" -> "Blueprint"
3. Подключите свой GitHub репозиторий
4. Выберите ветку для деплоя (обычно `main` или `master`)
5. Нажмите "Apply Blueprint"

Render автоматически создаст все необходимые сервисы, указанные в файле `render.yaml`:
- Веб-сервис для приложения
- MongoDB для хранения данных
- Redis для кэширования (если необходимо)

### 2. Настройка переменных окружения

Все необходимые переменные окружения уже настроены в файле `render.yaml`. При необходимости вы можете изменить их в панели управления сервисом на Render:
1. Перейдите в раздел "Environment"
2. Измените значения переменных по необходимости

### 3. Настройка автоматического деплоя

1. В разделе "Settings" убедитесь, что включена опция "Auto-Deploy"
2. При каждом пуше в выбранную ветку будет происходить автоматический деплой

## Проверка работоспособности

После успешного деплоя:
1. Откройте URL вашего сервиса на Render
2. Проверьте эндпоинт `/api/health` для проверки статуса сервера
3. Проверьте эндпоинт `/api/health/db` для проверки подключения к базе данных

## Решение проблем

### Проблема: Сервер не запускается

**Решение:**
- Проверьте логи в разделе "Logs" на Render
- Убедитесь, что все переменные окружения настроены правильно
- Проверьте подключение к MongoDB

### Проблема: Ошибка подключения к MongoDB

**Решение:**
- Убедитесь, что строка подключения MONGODB_URI указана правильно
- Проверьте, что сервис MongoDB запущен и работает корректно
- Проверьте правильность учетных данных пользователя MongoDB

### Проблема: Ошибка "No open ports detected"

**Решение:**
- Убедитесь, что сервер слушает порт, указанный в переменной окружения PORT (10000)
- Проверьте, что сервер запускается до подключения к MongoDB

## Полезные ссылки

- [Документация Render по веб-сервисам](https://render.com/docs/web-services)
- [Документация Render по Blueprint](https://render.com/docs/blueprint-spec)
- [Документация MongoDB](https://docs.mongodb.com/)
- [Документация МойСклад API](https://dev.moysklad.ru/doc/api/remap/1.2/) 